kind: pipeline
name: Ayra's Oven

platform:
  os: linux
  arch: amd64

clone:
  depth: 1

steps:
  - name: GCC-9.2.0
    image: ayrahikari/oven:latest
    environment:
      token:
        from_secret: token
      targetgrup:
        from_secret: targetgrup
      device: land
      kerneldir: kernel
      defconfig: land_defconfig
      kernelname: Ayra Kernel
      versi: v3.18.140
      unified: true

    commands:
      - curl -s -X POST https://api.telegram.org/bot$token/sendPhoto?chat_id=$targetgrup -d "photo=https://telegra.ph/file/6eefa9c3468f66b4af85b.jpg&parse_mode=markdown&caption=%60$(date '+%H:%M:%S - %d %b %Y')%60%0D%0AðŸŒº *$kernelname* build $versi for $device has been started by [Ayra Hikari](tg://user?id=388576209)" > /dev/null
      - pip3 install requests
      - bash COMPILER/CookingYukaAlt
    when:
      branch:
        - lineage-16.0

  - name: DRAGONTC-10
    image: ayrahikari/oven:latest
    environment:
      token:
        from_secret: token
      targetgrup:
        from_secret: targetgrup
      device: land
      kerneldir: kernel
      defconfig: land_defconfig
      kernelname: Ayra Kernel
      versi: v3.18.140
      unified: true
      buildtype: dtc

    commands:
      - pip3 install requests
      - bash COMPILER/CookingYukaAlt
    when:
      branch:
        - lineage-16.0

  - name: CLANG-10
    image: ayrahikari/oven:latest
    environment:
      token:
        from_secret: token
      targetgrup:
        from_secret: targetgrup
      device: land
      kerneldir: kernel
      defconfig: land_defconfig
      kernelname: Ayra Kernel
      versi: v3.18.140
      unified: true
      buildtype: clang

    commands:
      - pip3 install requests
      - bash COMPILER/CookingYukaAlt
    when:
      branch:
        - lineage-16.0
